   <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>http-huawei-hg5xx-vuln NSE Script -VER007</title>
    

</HEAD>






<a href="../nmap-script-help.html">HOME>>>>>>>>></a>



<h1>File <code>http-huawei-hg5xx-vuln</code></h1>



<p>


<a href="http://nmap.org/book/nse-script-format.html#nse-format-rules">脚本使用类型</a>:
portrule
<br>

  脚本所属分类:
  <i><a href="http://nmap.org/nsedoc/categories/exploit.html">exploit</a></i>, <i><a href="http://nmap.org/nsedoc/categories/vuln.html">vuln</a></i>
  <br>

脚本下载地址: <a href="http://nmap.org/svn/scripts/http-huawei-hg5xx-vuln.nse">http://nmap.org/svn/scripts/http-huawei-hg5xx-vuln.nse</a>
</p>



<h2> User Summary </h2>

<p>
Detects Huawei modems models HG530x, HG520x, HG510x (and possibly
others...) vulnerable to a remote credential and information
disclosure vulnerability. It also extracts the PPPoE credentials and
other interesting configuration values.
</p>
<p>
Attackers can query the URIs "/Listadeparametros.html" and "/wanfun.js" to extract sensitive information 
including PPPoE credentials, firmware version, model, gateway, dns servers and active connections among other values.
</p>
<p>
This script exploits two vulnerabilities. One was discovered and reported by Adiaz from Comunidad Underground de Mexico (<a href="http://underground.org.mx">http://underground.org.mx</a>) and it allows attackers to extract the pppoe password. The configuration disclosure vulnerability was discovered by Pedro Joaquin (<a href="http://hakim.ws">http://hakim.ws</a>).
</p>
<p>
References:
*<a href="http://websec.ca/advisories/view/Huawei-HG520c-3.10.18.x-information-disclosure">http://websec.ca/advisories/view/Huawei-HG520c-3.10.18.x-information-disclosure</a>
*<a href="http://routerpwn.com/#huawei">http://routerpwn.com/#huawei</a></p>







  
  
  
  

  
  
  
  

  
  
  
    
      
        
      
    
  
  
    
    
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  
  
    
    
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
  
  
    
    
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  



  <h2> Script Arguments </h2>
  <p>
    

    
      <h4> smbdomain, smbhash, smbnoguest, smbpassword, smbtype, smbusername </h4>
      See the documentation for the <a href="http://nmap.org/nsedoc/lib/smbauth.html#script-args">smbauth</a> library.
    
      <h4> http.max-cache-size, http.max-pipeline, http.pipeline, http.useragent </h4>
      See the documentation for the <a href="http://nmap.org/nsedoc/lib/http.html#script-args">http</a> library.
    
      <h4> vulns.showall </h4>
      See the documentation for the <a href="http://nmap.org/nsedoc/lib/vulns.html#script-args">vulns</a> library.
    
  </p>


<h2> Example Usage </h2>
<p>执行格式

  <ul>
  
    <li><pre>nmap -p80 --script http-huawei-hg5xx-vuln &lt;target&gt;</pre></li>
  
    <li><pre>nmap -sV http-huawei-hg5xx-vuln &lt;target&gt;
</pre></li>
  
  </ul>

</p>


  <h2> Script Output </h2>
<pre>PORT   STATE SERVICE VERSION
80/tcp open  http    Huawei aDSL modem EchoLife HG530 (V100R001B122gTelmex) 4.07 -- UPnP/1.0 (ZyXEL ZyWALL 2)
| http-huawei-hg5xx-vuln: 
|   VULNERABLE:
|   Remote credential and information disclosure in modems Huawei HG5XX
|     State: VULNERABLE (Exploitable)
|     Description:
|       Modems Huawei 530x, 520x and possibly others are vulnerable to remote credential and information disclosure. 
|       Attackers can query the URIs "/Listadeparametros.html" and "/wanfun.js" to extract sensitive information 
|       including PPPoE credentials, firmware version, model, gateway, dns servers and active connections among other values
|     Disclosure date: 2011-01-1
|     Extra information:
|       
|   Model:EchoLife HG530
|   Firmware version:V100R001B122gTelmex
|   External IP:xxx.xxx.xx.xxx
|   Gateway IP:xxx.xx.xxx.xxx
|   DNS 1:200.33.146.249
|   DNS 2:200.33.146.241
|   Network segment:192.168.1.0
|   Active ethernet connections:0
|   Active wireless connections:3
|   BSSID:0xdeadbeefcafe
|   Wireless Encryption (Boolean):1
|   PPPoE username:xxx
|   PPPoE password:xxx
|     References:
|       http://routerpwn.com/#huawei
|_      http://websec.ca/advisories/view/Huawei-HG520c-3.10.18.x-information-disclosure
</pre>



  <h2> Requires </h2>
  <ul>
  
     <li><a href="http://nmap.org/nsedoc/lib/http.html">http</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/nmap.html">nmap</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/shortport.html">shortport</a></li>
  
     <li><a href="">string</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/vulns.html">vulns</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/stdnse.html">stdnse</a></li>
  
  </ul>


<hr/>






<p><b>Author: </b>Paulino Calderon &lt;calderon () websec mx&gt;</p>



<p><b>License: </b> VER007 整理 <a href="http://www.ver007.com">http://www.ver007.com</a></p>









  

  

  

  




</BODY>
</HTML>


