   <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>asn-query NSE Script -VER007</title>
    

</HEAD>






<a href="../nmap-script-help.html">HOME>>>>>>>>></a>



<h1>File <code>asn-query</code></h1>



<p>


<a href="http://nmap.org/book/nse-script-format.html#nse-format-rules">脚本使用类型</a>:
hostrule
<br>

  脚本所属分类:
  <i><a href="http://nmap.org/nsedoc/categories/discovery.html">discovery</a></i>, <i><a href="http://nmap.org/nsedoc/categories/external.html">external</a></i>, <i><a href="http://nmap.org/nsedoc/categories/safe.html">safe</a></i>
  <br>

脚本下载地址: <a href="http://nmap.org/svn/scripts/asn-query.nse">http://nmap.org/svn/scripts/asn-query.nse</a>
</p>



<h2> User Summary </h2>

<p>
Maps IP addresses to autonomous system (AS) numbers.
</p>
<p>
The script works by sending DNS TXT queries to a DNS server which in
turn queries a third-party service provided by Team Cymru
(team-cymru.org) using an in-addr.arpa style zone set up especially for
use by Nmap. The responses to these queries contain both Origin and Peer
ASNs and their descriptions, displayed along with the BGP Prefix and
Country Code. The script caches results to reduce the number of queries
and should perform a single query for all scanned targets in a BGP
Prefix present in Team Cymru's database.
</p>
<p>
Be aware that any targets against which this script is run will be sent
to and potentially recorded by one or more DNS servers and Team Cymru.
In addition your IP address will be sent along with the ASN to a DNS
server (your default DNS server, or whichever one you specified with the
<code>dns</code> script argument).</p>







  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  



  <h2> Script Arguments </h2>
  <p>
    
      <h4> dns </h4>
      <p>
The address of a recursive nameserver to use (optional).</p>

    

    
  </p>


<h2> Example Usage </h2>
<p>执行格式

  <pre>nmap --script asn-query [--script-args dns=&lt;DNS server&gt;] &lt;target&gt;</pre>

</p>


  <h2> Script Output </h2>
<pre>Host script results:
|  asn-query:
|  BGP: 64.13.128.0/21 | Country: US
|    Origin AS: 10565 SVCOLO-AS - Silicon Valley Colocation, Inc.
|      Peer AS: 3561 6461
|  BGP: 64.13.128.0/18 | Country: US
|    Origin AS: 10565 SVCOLO-AS - Silicon Valley Colocation, Inc.
|_     Peer AS: 174 2914 6461</pre>



  <h2> Requires </h2>
  <ul>
  
     <li><a href="http://nmap.org/nsedoc/lib/dns.html">dns</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/ipOps.html">ipOps</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/nmap.html">nmap</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/stdnse.html">stdnse</a></li>
  
     <li><a href="">string</a></li>
  
     <li><a href="">table</a></li>
  
  </ul>


<hr/>






<p><b>Author: </b>jah, Michael Pattrick</p>



<p><b>License: </b> VER007 整理 <a href="http://www.ver007.com">http://www.ver007.com</a></p>








<h2> <font color="#ff0000">action</font> </h2>
<dl class="function">
  

<dt><a name="action"></a><strong>action</strong>&nbsp;(host)</dt>
<dd>

<p>
Cached results are checked before sending a query for the target and extracting the
relevent information from the response.  Mutual exclusion is used so that results can be
cached and so a single thread will be active at any time.</p>




<h3>Parameters</h3>
<ul>
	
	<li>
	  host:
          
            Host table.
          
	</li>
	
</ul>






<h3>Return value:</h3>
Formatted answers or <code>nil</code> on errors.



</dd>

</dl>




  

  
    <h2> <font color="#0000ff">hostrule</font> </h2>
    <dl class="function">
      

<dt><a name="hostrule"></a><strong>hostrule</strong>&nbsp;(host)</dt>
<dd>

<p>
This script will run for any non-private IP address.</p>




<h3>Parameters</h3>
<ul>
	
	<li>
	  host:
          
	</li>
	
</ul>








</dd>

    </dl>
  

  

  




</BODY>
</HTML>


