   <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>mysql-audit NSE Script -VER007</title>
    

</HEAD>






<a href="../nmap-script-help.html">HOME>>>>>>>>></a>



<h1>File <code>mysql-audit</code></h1>



<p>


<a href="http://nmap.org/book/nse-script-format.html#nse-format-rules">脚本使用类型</a>:
portrule
<br>

  脚本所属分类:
  <i><a href="http://nmap.org/nsedoc/categories/discovery.html">discovery</a></i>, <i><a href="http://nmap.org/nsedoc/categories/safe.html">safe</a></i>
  <br>

脚本下载地址: <a href="http://nmap.org/svn/scripts/mysql-audit.nse">http://nmap.org/svn/scripts/mysql-audit.nse</a>
</p>



<h2> User Summary </h2>

<p>
Audits MySQL database server security configuration against parts of
the CIS MySQL v1.0.2 benchmark (the engine can be used for other MySQL
audits by creating appropriate audit files).</p>







  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  



  <h2> Script Arguments </h2>
  <p>
    
      <h4> mysql-audit.password </h4>
      <p>
the password with which to connect to the database</p>

    
      <h4> mysql-audit.username </h4>
      <p>
the username with which to connect to the database</p>

    
      <h4> mysql-audit.filename </h4>
      <p>
the name of the file containing the audit rulebase</p>

    

    
  </p>


<h2> Example Usage </h2>
<p>执行格式

  <pre>nmap -p 3306 --script mysql-audit --script-args "mysql-audit.username='root', \
	mysql-audit.password='foobar',mysql-audit.filename='nselib/data/mysql-cis.audit'"
</pre>

</p>


  <h2> Script Output </h2>
<pre>PORT     STATE SERVICE
3306/tcp open  mysql
| mysql-audit: 
|   CIS MySQL Benchmarks v1.0.2
|       3.1: Skip symbolic links =&gt; PASS
|       3.2: Logs not on system partition =&gt; PASS
|       3.2: Logs not on database partition =&gt; PASS
|       4.1: Supported version of MySQL =&gt; REVIEW
|         Version: 5.1.54-1ubuntu4
|       4.4: Remove test database =&gt; PASS
|       4.5: Change admin account name =&gt; FAIL
|       4.7: Verify Secure Password Hashes =&gt; PASS
|       4.9: Wildcards in user hostname =&gt; FAIL
|         The following users were found with wildcards in hostname
|           root
|           super
|           super2
|       4.10: No blank passwords =&gt; PASS
|       4.11: Anonymous account =&gt; PASS
|       5.1: Access to mysql database =&gt; REVIEW
|         Verify the following users that have access to the MySQL database
|           user              host
|           root              localhost
|           root              patrik-11
|           root              127.0.0.1
|           debian-sys-maint  localhost
|           root              %
|           super             %
|       5.2: Do not grant FILE privileges to non Admin users =&gt; REVIEW
|         The following users were found having the FILE privilege
|           super
|           super2
|       5.3: Do not grant PROCESS privileges to non Admin users =&gt; REVIEW
|         The following users were found having the PROCESS privilege
|           super
|       5.4: Do not grant SUPER privileges to non Admin users =&gt; REVIEW
|         The following users were found having the SUPER privilege
|           super
|       5.5: Do not grant SHUTDOWN privileges to non Admin users =&gt; REVIEW
|         The following users were found having the SHUTDOWN privilege
|           super
|       5.6: Do not grant CREATE USER privileges to non Admin users =&gt; REVIEW
|         The following users were found having the CREATE USER privilege
|           super
|       5.7: Do not grant RELOAD privileges to non Admin users =&gt; REVIEW
|         The following users were found having the RELOAD privilege
|           super
|       5.8: Do not grant GRANT privileges to non Admin users =&gt; PASS
|       6.2: Disable Load data local =&gt; FAIL
|       6.3: Disable old password hashing =&gt; PASS
|       6.4: Safe show database =&gt; FAIL
|       6.5: Secure auth =&gt; FAIL
|       6.6: Grant tables =&gt; FAIL
|       6.7: Skip merge =&gt; FAIL
|       6.8: Skip networking =&gt; FAIL
|       6.9: Safe user create =&gt; FAIL
|       6.10: Skip symbolic links =&gt; FAIL
|       
|_      The audit was performed using the db-account: root</pre>



  <h2> Requires </h2>
  <ul>
  
     <li><a href="http://nmap.org/nsedoc/lib/mysql.html">mysql</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/nmap.html">nmap</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/shortport.html">shortport</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/stdnse.html">stdnse</a></li>
  
     <li><a href="">table</a></li>
  
  </ul>


<hr/>






<p><b>Author: </b>Patrik Karlsson</p>



<p><b>License: </b> VER007 整理 <a href="http://www.ver007.com">http://www.ver007.com</a></p>









  

  

  

  




</BODY>
</HTML>


