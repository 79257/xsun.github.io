   <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
    <title>mtrace NSE Script -VER007</title>
    

</HEAD>






<a href="../nmap-script-help.html">HOME>>>>>>>>></a>



<h1>File <code>mtrace</code></h1>



<p>


<a href="http://nmap.org/book/nse-script-format.html#nse-format-rules">脚本使用类型</a>:
prerule
<br>

  脚本所属分类:
  <i><a href="http://nmap.org/nsedoc/categories/discovery.html">discovery</a></i>, <i><a href="http://nmap.org/nsedoc/categories/safe.html">safe</a></i>, <i><a href="http://nmap.org/nsedoc/categories/broadcast.html">broadcast</a></i>
  <br>

脚本下载地址: <a href="http://nmap.org/svn/scripts/mtrace.nse">http://nmap.org/svn/scripts/mtrace.nse</a>
</p>



<h2> User Summary </h2>

<p>
Queries for the multicast path from a source to a destination host.
</p>
<p>
This works by sending an IGMP Traceroute Query and listening for IGMP
Traceroute responses. The Traceroute Query is sent to the first hop and
contains information about source, destination and multicast group addresses.
First hop defaults to the multicast All routers address. The default multicast
group address is 0.0.0.0 and the default destination is our own host address. A
source address must be provided. The responses are parsed to get interesting
information about interface addresses, used protocols and error codes.
</p>
<p>
This is similar to the mtrace utility provided in Cisco IOS.</p>







  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  

  
  
  
  



  <h2> Script Arguments </h2>
  <p>
    
      <h4> mtrace.fromip </h4>
      <p>
Source address from which to traceroute.</p>

    
      <h4> mtrace.group </h4>
      <p>
Multicast group address for the traceroute.
Defaults to <code>0.0.0.0</code> which represents all group addresses.</p>

    
      <h4> mtrace.timeout </h4>
      <p>
Time to wait for responses.
Defaults to <code>7s</code>.</p>

    
      <h4> mtrace.firsthop </h4>
      <p>
Host to which the query is sent. If not set, the
query will be sent to <code>224.0.0.2</code>.</p>

    
      <h4> mtrace.toip </h4>
      <p>
Destination address to which to traceroute.
Defaults to our host address.</p>

    

    
  </p>


<h2> Example Usage </h2>
<p>执行格式

  <pre>nmap --script mtrace --script-args 'mtrace.fromip=172.16.45.4'
</pre>

</p>


  <h2> Script Output </h2>
<pre>Pre-scan script results:
| mtrace: 
|   Group 0.0.0.0 from 172.16.45.4 to 172.16.0.1
|   Source: 172.16.45.4
|     In address: 172.16.34.3
|       Out address: 172.16.0.3
|       Protocol: PIM
|     In address: 172.16.45.4
|       Out address: 172.16.34.4
|       Protocol: PIM
|   Source: 172.16.45.4
|     In address: 172.16.13.1
|       Out address: 172.16.0.2
|       Protocol: PIM / Static
|     In address: 172.16.34.3
|       Out address: 172.16.13.3
|       Protocol: PIM
|     In address: 172.16.45.4
|       Out address: 172.16.34.4
|_      Protocol: PIM</pre>



  <h2> Requires </h2>
  <ul>
  
     <li><a href="http://nmap.org/nsedoc/lib/nmap.html">nmap</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/packet.html">packet</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/ipOps.html">ipOps</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/bin.html">bin</a></li>
  
     <li><a href="http://nmap.org/nsedoc/lib/stdnse.html">stdnse</a></li>
  
     <li><a href="">table</a></li>
  
     <li><a href="">math</a></li>
  
     <li><a href="">string</a></li>
  
  </ul>


<hr/>






<p><b>Author: </b>Hani Benhabiles</p>



<p><b>License: </b> VER007 整理 <a href="http://www.ver007.com">http://www.ver007.com</a></p>









  

  

  

  




</BODY>
</HTML>


